"use strict";(self.webpackChunkopenfrontend_framework=self.webpackChunkopenfrontend_framework||[]).push([[912],{3584:function(t,e,n){n.r(e),n.d(e,{default:function(){return D},initMultiple:function(){return E}});var i=n(3066),o=n(8636),a=n(6993),l=n(500),r=n(5180),s=n(7920),c=n(6400);class d extends s.be{constructor(){super(...arguments),this.buildDayTableModel=(0,s.z)(r.zm),this.slicer=new r.Ym,this.state={labelId:(0,s.a5)()}}render(){const{props:t,state:e,context:n}=this,{dateProfile:i,forPrint:o}=t,{options:a}=n,l=this.buildDayTableModel(i,n.dateProfileGenerator),d=this.slicer.sliceProps(t,i,a.nextDayThreshold,n,l),h=null!=t.tableWidth?t.tableWidth/a.aspectRatio:null,u=l.cells.length,m=null!=h?h/u:null;return(0,c.az)("div",{ref:t.elRef,"data-date":t.isoDateStr,className:"fc-multimonth-month",style:{width:t.width},role:"grid","aria-labelledby":e.labelId},(0,c.az)("div",{className:"fc-multimonth-header",style:{marginBottom:m},role:"presentation"},(0,c.az)("div",{className:"fc-multimonth-title",id:e.labelId},n.dateEnv.format(t.dateProfile.currentRange.start,t.titleFormat)),(0,c.az)("table",{className:["fc-multimonth-header-table",n.theme.getClass("table")].join(" "),role:"presentation"},(0,c.az)("thead",{role:"rowgroup"},(0,c.az)(s.bK,{dateProfile:t.dateProfile,dates:l.headerDates,datesRepDistinctDays:!1})))),(0,c.az)("div",{className:["fc-multimonth-daygrid","fc-daygrid","fc-daygrid-body",!o&&"fc-daygrid-body-balanced",o&&"fc-daygrid-body-unbalanced",o&&"fc-daygrid-body-natural"].join(" "),style:{marginTop:-m}},(0,c.az)("table",{className:["fc-multimonth-daygrid-table",n.theme.getClass("table")].join(" "),style:{height:o?"":h},role:"presentation"},(0,c.az)("tbody",{role:"rowgroup"},(0,c.az)(r.iG,Object.assign({},d,{dateProfile:i,cells:l.cells,eventSelection:t.eventSelection,dayMaxEvents:a.hasOwnProperty("dayMaxEvents")?a.dayMaxEvents:!o,dayMaxEventRows:a.hasOwnProperty("dayMaxEventRows")?a.dayMaxEventRows:!o,showWeekNumbers:a.weekNumbers,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:o}))))))}}class h extends s.be{constructor(){super(...arguments),this.splitDateProfileByMonth=(0,s.z)(m),this.buildMonthFormat=(0,s.z)(p),this.scrollElRef=(0,c.Vf)(),this.firstMonthElRef=(0,c.Vf)(),this.needsScrollReset=!1,this.handleSizing=t=>{t&&this.updateSize()}}render(){const{context:t,props:e,state:n}=this,{options:i}=t,{clientWidth:o,clientHeight:a}=n,l=n.monthHPadding||0;let r=Math.min(null!=o?Math.floor(o/(i.multiMonthMinWidth+l)):1,i.multiMonthMaxColumns)||1;i.duration.months>0&&(r=Math.min(r,i.duration.months));const h=100/r+"%",u=null==o?null:o/r-l,m=null!=o&&1===r,f=this.splitDateProfileByMonth(t.dateProfileGenerator,e.dateProfile,t.dateEnv,!m&&i.fixedWeekCount,i.showNonCurrentDates),g=this.buildMonthFormat(i.multiMonthTitleFormat,f),p=["fc-multimonth",m?"fc-multimonth-singlecol":"fc-multimonth-multicol",null!=u&&u<400?"fc-multimonth-compact":""];return(0,c.az)(s.ct,{elRef:this.scrollElRef,elClasses:p,viewSpec:t.viewSpec},f.map(((t,n)=>{const i=(0,s.bx)(t.currentRange.start);return(0,c.az)(d,Object.assign({},e,{key:i,isoDateStr:i,elRef:0===n?this.firstMonthElRef:void 0,titleFormat:g,dateProfile:t,width:h,tableWidth:u,clientWidth:o,clientHeight:a}))})))}componentDidMount(){this.updateSize(),this.context.addResizeHandler(this.handleSizing),this.requestScrollReset()}componentDidUpdate(t){(0,s.E)(t,this.props)||this.handleSizing(!1),t.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}updateSize(){const t=this.scrollElRef.current,e=this.firstMonthElRef.current;t&&this.setState({clientWidth:t.clientWidth,clientHeight:t.clientHeight}),e&&t&&null==this.state.monthHPadding&&this.setState({monthHPadding:t.clientWidth-e.firstChild.offsetWidth})}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&null!=this.state.monthHPadding){const{currentDate:t}=this.props.dateProfile,e=this.scrollElRef.current,n=e.querySelector('[data-date="'.concat((0,s.bx)(t),'"]'));e.scrollTop=n.getBoundingClientRect().top-this.firstMonthElRef.current.getBoundingClientRect().top,this.needsScrollReset=!1}}shouldComponentUpdate(){return!0}}const u=(0,s.d)(1,"month");function m(t,e,n,i,o){const{start:a,end:l}=e.currentRange;let c=a;const d=[];for(;c.valueOf()<l.valueOf();){const a=n.add(c,u),l={start:t.skipHiddenDays(c),end:t.skipHiddenDays(a,-1,!0)};let h=(0,r.Wx)({currentRange:l,snapToWeek:!0,fixedWeekCount:i,dateEnv:n});h={start:t.skipHiddenDays(h.start),end:t.skipHiddenDays(h.end,-1,!0)};const m=e.activeRange?(0,s.o)(e.activeRange,o?h:l):null;d.push({currentDate:e.currentDate,isValid:e.isValid,validRange:e.validRange,renderRange:h,activeRange:m,currentRange:l,currentRangeUnit:"month",isRangeAllDay:!0,dateIncrement:e.dateIncrement,slotMinTime:e.slotMaxTime,slotMaxTime:e.slotMinTime}),c=a}return d}const f=(0,s.x)({year:"numeric",month:"long"}),g=(0,s.x)({month:"long"});function p(t,e){return t||(e[0].currentRange.start.getUTCFullYear()!==e[e.length-1].currentRange.start.getUTCFullYear()?f:g)}const v={multiMonthTitleFormat:s.x,multiMonthMaxColumns:Number,multiMonthMinWidth:Number};(0,s.cw)(".fc .fc-multimonth{border:1px solid var(--fc-border-color);display:flex;flex-wrap:wrap;overflow-x:hidden;overflow-y:auto}.fc .fc-multimonth-title{font-size:1.2em;font-weight:700;padding:1em 0;text-align:center}.fc .fc-multimonth-daygrid{background:var(--fc-page-bg-color)}.fc .fc-multimonth-daygrid-table,.fc .fc-multimonth-header-table{table-layout:fixed;width:100%}.fc .fc-multimonth-daygrid-table{border-top-style:hidden!important}.fc .fc-multimonth-singlecol .fc-multimonth{position:relative}.fc .fc-multimonth-singlecol .fc-multimonth-header{background:var(--fc-page-bg-color);position:relative;top:0;z-index:2}.fc .fc-multimonth-singlecol .fc-multimonth-daygrid{position:relative;z-index:1}.fc .fc-multimonth-singlecol .fc-multimonth-daygrid-table,.fc .fc-multimonth-singlecol .fc-multimonth-header-table{border-left-style:hidden;border-right-style:hidden}.fc .fc-multimonth-singlecol .fc-multimonth-month:last-child .fc-multimonth-daygrid-table{border-bottom-style:hidden}.fc .fc-multimonth-multicol{line-height:1}.fc .fc-multimonth-multicol .fc-multimonth-month{padding:0 1.2em 1.2em}.fc .fc-multimonth-multicol .fc-daygrid-more-link{border:1px solid var(--fc-event-border-color);display:block;float:none;padding:1px}.fc .fc-multimonth-compact{line-height:1}.fc .fc-multimonth-compact .fc-multimonth-daygrid-table,.fc .fc-multimonth-compact .fc-multimonth-header-table{font-size:.9em}.fc-media-screen .fc-multimonth-singlecol .fc-multimonth-header{position:sticky}.fc-media-print .fc-multimonth{overflow:visible}");var y=(0,o.rx)({name:"@fullcalendar/multimonth",initialView:"multiMonthYear",optionRefiners:v,views:{multiMonth:{component:h,dateProfileGeneratorClass:r.XK,multiMonthMinWidth:350,multiMonthMaxColumns:3},multiMonthYear:{type:"multiMonth",duration:{years:1},fixedWeekCount:!0,showNonCurrentDates:!1}}});class b extends s.T{}b.prototype.classes={root:"fc-theme-bootstrap",tableCellShaded:"fc-of-table-cell-shaded",buttonGroup:"btn-group",button:"btn",buttonActive:"active",popover:"popover",popoverHeader:"popover-header",popoverContent:"popover-body"},b.prototype.baseIconClass="",b.prototype.iconClasses={prev:"fc-icon-prev",next:"fc-icon-next",prevYear:"fc-icon-prev-year",nextYear:"fc-icon-next-year",dayGridMonth:"fc-icon-grid",listMonth:"fc-icon-list"},b.prototype.rtlIconClasses={prev:"fc-icon-prev",next:"fc-icon-next",prevYear:"fc-icon-prev-year",nextYear:"fc-icon-next-year"};var M=(0,o.rx)({name:"bootstrap",themeClasses:{bootstrap:b}});const w={de:()=>n.e(566).then(n.bind(n,1566)).then((t=>t.default)),fr:()=>n.e(374).then(n.bind(n,3374)).then((t=>t.default)),it:()=>n.e(731).then(n.bind(n,6731)).then((t=>t.default))},_={events:"array",eventsFeedUrl:"string|undefined",eventsFeedUrlStartParam:"string",eventsFeedUrlEndParam:"string",layout:"string",miniMonthMinWidth:"number",title:"string|undefined",viewToggler:"boolean"},x={allDay:"boolean",content:"string|undefined",contentUrl:"string|undefined",display:"string|undefined",end:"date|number|string|undefined",start:"date|number|string",title:"string"},R={events:[],eventsFeedUrl:void 0,eventsFeedUrlStartParam:"calendar_start",eventsFeedUrlEndParam:"calendar_end",layout:"full",miniMonthMinWidth:265,title:void 0,viewToggler:!0};class C extends i.Z{constructor(t,e){super(t,e),this._initCalendar()}static get Default(){return R}static get DefaultType(){return _}static get NAME(){return"calendar"}async _initCalendar(){this._eventsCache=void 0,this._eventsSlicedCache=new Map,this._calendar=new o.f(this._element,await this._getOptions()),this._calendar.render(),this._element.dispatchEvent(new CustomEvent("initialized.of.calendar"))}async _openEventPopover(t){const e=t.event;let n;n=e._def.extendedProps.contentUrl?await this._fetchEventContentFromUrl(e):this._fetchEventContentFromData(e),n&&await this._openPopover(t.el,n,"listMonth"===this._calendar.view.type?t.jsEvent.target:null)}_fetchEventContentFromData(t){var e;return null===(e=this._getEvents()[t.id])||void 0===e?void 0:e.content}async _fetchEventContentFromUrl(t){return fetch(t._def.extendedProps.contentUrl,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((t=>t.text()))}async _openPopover(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i={content:e,html:!0,placement:"auto",sanitize:!1};"listMonth"===this._calendar.view.type&&(i.fallbackPlacements=["top","bottom","right","left"],i.placement="top");const o=await openFrontend.Popover.then((e=>e.getOrCreateInstance(t,i)));o._isShown()?(o.hide(),o.removeClickListener()):(this._hidePopoverOnClickOutside(o,n),o.show())}async _fetchEvents(t){return this._config.eventsFeedUrl?this._fetchEventsFromUrl(t):this._fetchEventsFromData(t)}async _fetchEventsFromData(t){return new Promise((e=>{const n="".concat(t.startStr,"_").concat(t.endStr);this._eventsSlicedCache.has(n)||this._eventsSlicedCache.set(n,this._getEvents().filter((e=>{let n=e.start;return"string"==typeof n&&(n=new Date(n)),n>=t.start&&n<t.end}))),e(this._eventsSlicedCache.get(n))}))}async _fetchEventsFromUrl(t){return new Promise((e=>{fetch("".concat(this._config.eventsFeedUrl).concat(this._config.eventsFeedUrl.includes("?")?"&":"?").concat(this._config.eventsFeedUrlStartParam,"=").concat(t.startStr,"&").concat(this._config.eventsFeedUrlEndParam,"=").concat(t.endStr),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then((t=>t.json())).then((t=>{this._calendar.setOption("validRange",this._getValidRange(t)),e(t)}))}))}async _getOptions(){const t={events:(t,e)=>this._fetchEvents(t).then(e),eventClick:t=>this._openEventPopover(t),eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},firstDay:1,headerToolbar:{start:"title",center:"",end:"today prev,next"},height:"auto",plugins:[M],themeSystem:"bootstrap"};let e=document.documentElement.lang;switch(e.length>2&&(e=e.substring(0,2)),"en"!==e&&w.hasOwnProperty(e)&&(t.locale=await w[e]()),this._config.title&&(t.titleFormat=()=>this._config.title),t.viewDidMount=()=>{const t=[...this._element.querySelectorAll("button.fc-today-button, button.fc-prev-button, button.fc-next-button")],e=t.filter((t=>t.disabled)).length===t.length;t.forEach((t=>{(t.classList.contains("fc-prev-button")||t.classList.contains("fc-next-button"))&&t.parentElement.classList.toggle("d-none",e),t.classList.toggle("d-none",e)}))},this._config.layout){case"full":t.initialView="dayGridMonth",t.plugins.push(a.Z,l.Z),t.headerToolbar.end=this._config.viewToggler?"dayGridMonth,listMonth today prev,next":"today prev,next",t.views={dayGridMonth:{type:"dayGridMonth",dayMaxEvents:1}};break;case"mini":t.initialView="miniView",t.plugins.push(y),t.multiMonthMinWidth=this._config.miniMonthMinWidth,t.multiMonthTitleFormat={month:"long",year:"numeric"},t.views={miniView:{type:"multiMonth",duration:{months:2},dayMaxEvents:1,dayMaxEventRows:0,showNonCurrentDates:!1}},t.eventDidMount=t=>{var e;return null===(e=t.el.closest("td"))||void 0===e?void 0:e.classList.add("fc-of-mini-event-day")},t.moreLinkClick=async t=>(await this._openPopover(t.jsEvent.target,t.allSegs.map((t=>{var e;return null!==(e=events[t.event.id])&&void 0!==e&&e.content?'<div class="popover-body-row">'.concat(events[t.event.id].content,"</div>"):""})).join(""),t.jsEvent.target),"_"),t.moreLinkDidMount=t=>{var e;null===(e=t.el.closest("td"))||void 0===e||e.classList.add("fc-of-mini-event-day"),t.el.title=""};break;default:throw new Error("Unsupported layout: ".concat(this._config.layout))}if(!this._config.eventsFeedUrl){const e=this._getEvents();e.length>0&&(t.validRange=this._getValidRange(e))}return t}_getEvents(){if(void 0===this._eventsCache){this._config.events.forEach((t=>this._typeCheckConfig(t,x)));let t=[...this._config.events];if("mini"===this._config.layout){const e=[];for(let n of t){if(!n.hasOwnProperty("end")){e.push(n);continue}const t=new Date(n.start),i=new Date(n.end);if(t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate())continue;const o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0);for(;o<a;)e.push({...n,start:new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0),end:new Date(o.getFullYear(),o.getMonth(),o.getDate(),23,59,59)}),o.setDate(o.getDate()+1)}t=e}this._eventsCache=t.map(((t,e)=>({...t,id:e})))}return this._eventsCache}_getValidRange(t){const e=new Date(t.map((t=>t.start)).reduce(((t,e)=>t<e?t:e)));let n=t.filter((t=>t.hasOwnProperty("end"))).map((t=>t.end)).reduce(((t,e)=>t>e?t:e),0);n||(n=t.map((t=>t.start)).reduce(((t,e)=>t>e?t:e))),n=new Date(n);let i=new Date(e.getFullYear(),e.getMonth(),1),o=new Date(n.getFullYear(),n.getMonth()+1,0);if("mini"===this._config.layout){let t=12*(o.getFullYear()-i.getFullYear())-i.getMonth()+o.getMonth()+1;t<=2?t=2:t%2!=0&&(t=2*Math.ceil(t/2));let e=new Date(i);e.setMonth(e.getMonth()+t),e>o&&(o=e)}return{start:i,end:o}}_hidePopoverOnClickOutside(t,e){const n=n=>{!t.tip.contains(n.target)&&(null===e&&t._element!==n.target||null!==e&&!e.contains(n.target))&&(t.hide(),t.removeClickListener())};t.removeClickListener=()=>document.removeEventListener("click",n),document.addEventListener("click",n)}}function E(t){for(const e of t)C.getOrCreateInstance(e,e.dataset.ofCalendar?JSON.parse(e.dataset.ofCalendar):{})}var D=C}}]);